var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(o,n){function r(t){try{h(s.next(t))}catch(e){n(e)}}function a(t){try{h(s["throw"](t))}catch(e){n(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(r,a)}h((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,n&&(r=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){h.label=i[1];break}if(6===i[0]&&h.label<r[1]){h.label=r[1],r=i;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(i);break}r[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,n,r,a,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},StepType;!function(t){t[t.wait=0]="wait",t[t.exec=1]="exec",t[t.block=2]="block"}(StepType||(StepType={}));var Step=function(){function t(){this.m_taskList=[]}return t.prototype.wait=function(t){var e=this;return this.m_taskList.push({type:StepType.wait,data:t}),egret.setTimeout(function(){e.check()},this,0),this},t.prototype.exec=function(t,e){var i=this;return this.m_taskList.push({type:StepType.exec,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},t.prototype.block=function(t,e){var i=this;return this.m_taskList.push({type:StepType.block,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},t.prototype.next=function(){this.m_waitting=!1,egret.clearTimeout(this.m_timeId),this.check()},t.prototype.clear=function(){this.m_waitting=!1,egret.clearTimeout(this.m_timeId),this.m_taskList.length=0},t.prototype.check=function(){if(!this.m_waitting&&this.m_taskList.length>0){var t=this.m_taskList.shift();this.checkTask(t)}},t.prototype.checkTask=function(t){t.type==StepType.wait?this.doWait(t):t.type==StepType.exec?this.doExec(t):t.type==StepType.block&&this.doBlock(t)},t.prototype.doWait=function(t){var e=this,i=t.data;this.m_waitting=!0,this.m_timeId=egret.setTimeout(function(){e.m_waitting=!1,e.check()},this,i)},t.prototype.doExec=function(t){var e=t.data.func,i=t.data.thisObj;e.call(i),this.check()},t.prototype.doBlock=function(t){this.m_waitting=!0;var e=t.data.func,i=t.data.thisObj;e.call(i)},t}();__reflect(Step.prototype,"Step");var Workflow=function(){function t(){this.m_step=new Step,this.m_list=[]}return t.prototype.addWait=function(t){this.m_list.push({type:StepType.wait,data:t})},t.prototype.addExec=function(t,e){this.m_list.push({type:StepType.exec,data:{func:t,thisObj:e}})},t.prototype.addBlock=function(t,e){this.m_list.push({type:StepType.block,data:{func:t,thisObj:e}})},t.prototype.run=function(){this.m_step.clear();for(var t=0;t<this.m_list.length;t++){var e=this.m_list[t];e.type==StepType.wait?this.m_step.wait(e.data):e.type==StepType.exec?this.m_step.exec(e.func,e.thisObj):e.type==StepType.block&&this.m_step.block(e.func,e.thisObj)}},t.prototype.next=function(){this.m_step.next()},t}();__reflect(Workflow.prototype,"Workflow");var CountLoves=function(t){function e(){var e=t.call(this)||this;return e.count=3,e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=this.createBitmapByName("love_panel_png");this.addChild(t);var i=this.createBitmapByName("love_png");this.addChild(i),i.name="love",i.anchorOffsetX=-25,i.anchorOffsetY=-14,this._topMask=new egret.Shape,this.addChild(this._topMask),this._topMask.name="mask",this._topMask.graphics.beginFill(0,1),this._topMask.graphics.drawRect(0,0,e.MOVEDIS*e.NUM,51),this._topMask.graphics.endFill(),this._topMask.anchorOffsetX=-25,this._topMask.anchorOffsetY=-14,i.mask=this._topMask,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.prototype.add=function(){this.count>=e.NUM||(this.count++,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.cut=function(){this.count<=0||(this.count--,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createDisobj=function(t){for(var e=new egret.Sprite,i=0;i<t.length;i++)e.addChild(t[i]);return e},e.prototype.reset=function(){this.count=e.NUM,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.MOVEDIS=74,e.NUM=3,e}(egret.Sprite);__reflect(CountLoves.prototype,"CountLoves");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.graphics.beginFill(3368601,1),this.graphics.drawRect(0,0,1366,1024),this.graphics.endFill(),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.textColor=16777215,this.textField.x=.5*(1366-this.textField.width),this.textField.y=.5*(1024-this.textField.height),this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+Math.round(t/e*100)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.isResourceLoadEnd=!1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.loadingView.x=(this.stage.stageWidth-this.loadingView.width)/2,this.loadingView.y=(this.stage.stageHeight-this.loadingView.height)/2,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onSceneLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onSceneLoadComplete=function(t){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onSceneLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUnitLoadComplete,this);var i,s=GetRequestObject();return null==s?void Println("请求数据为null，无法加载相应单元的数据"):null==s.assetsName||void 0==s.assetsName||""==s.assetsName?void Println("请求的assetsName为null，无法加载相应单元的数据"):(i=s.assetsName,e.sourceName=i,void RES.loadGroup(i))},e.prototype.onUnitLoadComplete=function(t){this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUnitLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,Source.init(),this.startCreateScene()},e.prototype.onItemLoadError=function(t){Println("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){Println("Group:"+t.groupName+" has failed to load"),this.onSceneLoadComplete(t)},e.prototype.onResourceProgress=function(t){this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){this.stage.maxTouches=1,PublicTool.stageWidth=this.stage.stageWidth,PublicTool.stageHeight=this.stage.stageHeight;var t=new SpaceAdventure;this.addChild(t)},e.sourceName="",e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var QuestionCompoment=function(t){function e(){var e=t.call(this)||this;return e._showNum=3,e._randomHeight=[110,406,706],e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){for(var t=0;t<this._showNum;t++){var e=new CardComponent(t+1);this.addChild(e),e.x=1366}this._questionSound=new SoundPlayer},e.prototype.startQuestion=function(t){for(var e=Source.randomIndex(this._showNum),i=0;1>i;i++){var s=this.getChildAt(i);if(i>0){var o=Source.questionList[t][i-1];s.addImg(Source.images[o]),s.name=Source.list[o].title}else s.name="";s.x=1366+300*Math.random(),s.y=this._randomHeight[e[i]],s.addEventListener(egret.Event.ENTER_FRAME,this.onCardMove,this),egret.Tween.get(s,{loop:!0}).to({x:-420},1e4)}this.read(t)},e.prototype.read=function(t){this.answer=Source.list[t%Source.images.length].title,egret.log("this.answer:",this.answer),this._questionSound.clear(),this._questionSound.playRes(Source.list[t%Source.images.length].audio)},e.prototype.onCardMove=function(t){var e=t.target;if(this.hitTestFun){var i=this.localToGlobal(e.x,e.y);this.hitTestFun.apply(this.parent,[i.x,i.y,e])}},e.prototype.stop=function(){for(var t=0;t<this.numChildren;t++){var e=this.getChildAt(t);egret.Tween.pauseTweens(e),e.hasEventListener(egret.Event.ENTER_FRAME)&&e.removeEventListener(egret.Event.ENTER_FRAME,this.onCardMove,this)}},e}(egret.Sprite);__reflect(QuestionCompoment.prototype,"QuestionCompoment");var SoundPlayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.exec=function(t,e){var i=this;return this.m_taskList.push({type:StepType.exec,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},e.prototype.playRes=function(t,e,i){var s=this;void 0===e&&(e=1),void 0===i&&(i=1),Println("playRes key:"+t+" loop:"+e+" volume:"+i);var o={type:"playRes",data:{key:t,loop:e,volume:i}};return this.m_waitting?(this.m_taskList.push(o),egret.setTimeout(function(){s.check()},this,0)):this.doPlayRes(o),this},e.prototype.checkTask=function(e){t.prototype.checkTask.call(this,e),"playRes"==e.type&&this.doPlayRes(e)},e.prototype.doPlayRes=function(t){this.m_waitting=!0;var e=t.data.key;this._loop=t.data.loop,this._volume=t.data.volume,this.stopSound(),this._sound=RES.getRes(e),this._channel=this._sound.play(0,this._loop),this._channel.volume=this._volume,this._channel.addEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this)},e.prototype.stopSound=function(){this._channel&&(this._channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),this._channel.stop(),this._channel=null)},e.prototype.onPlayComplete=function(t){this.stopSound(),this.m_waitting=!1,this.check()},e.prototype.clear=function(){t.prototype.clear.call(this),this.stopSound()},e}(Step);__reflect(SoundPlayer.prototype,"SoundPlayer");var SpaceAdventure=function(t){function e(){var e=t.call(this)||this;return e._qwdSpeed=10,e._cardSpeed=6,e._questionIndex=0,e._showNum=3,e._randomHeight=[263,559,859],e._testDis=200,e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this._bg=new Bg,this.addChild(this._bg),this._qwd=Source.createBitmapByName("spaceadventure_4_png"),this.addChild(this._qwd),this._qwd.anchorOffsetX=.5*this._qwd.width,this._qwd.anchorOffsetY=.5*this._qwd.height,this._qwd.x=3+.5*this._qwd.width,this._qwd.y=399+.5*this._qwd.height,this._questionSp=new egret.Sprite,this.addChild(this._questionSp);for(var t=0;t<this._showNum;t++){var e=new CardComponent(t+1);this._questionSp.addChild(e),e.x=1366}this._questionSound=new SoundPlayer,this._loves=new CountLoves,this.addChild(this._loves),this._loves.x=182.5,this._loves.y=11.5,this._stars=new CountStars,this.addChild(this._stars),this._stars.x=749,this._stars.y=22.5,this._upBtn=new EButton(this,"btn_up_png",this.onUpBtnBegin,this.onUpBtnEnd,"",30,3,null),PublicTool.setXY(this._upBtn,31.7,837.75),this.addChild(this._upBtn),this._downBtn=new EButton(this,"btn_down_png",this.onDownBtnBegin,this.onDownBtnEnd,"",30,3,null),PublicTool.setXY(this._downBtn,1176.6,837.75),this.addChild(this._downBtn),this._overPage=new OverPage,this.addChild(this._overPage),this.initListener()},e.prototype.initListener=function(){this._overPage.addEventListener(egret.Event.COMPLETE,this.again,this),this._overPage.addEventListener(egret.Event.CHANGE,this.start,this)},e.prototype.startQuestion=function(t){for(var e=Source.randomIndex(this._showNum),i=0;i<this._showNum;i++){var s=this._questionSp.getChildAt(i);if(i>0){var o=Source.questionList[t][i-1];s.addImg(Source.images[o]),s.name=Source.list[o].title}else s.name="";s.x=1366+300*Math.random(),s.y=this._randomHeight[e[i]],s.addEventListener(egret.Event.ENTER_FRAME,this.onCardMove,this)}this.read(t)},e.prototype.read=function(t){this._answer=Source.list[t%Source.images.length].title,this._questionSound.clear(),this._questionSound.playRes(Source.list[t%Source.images.length].audio)},e.prototype.onCardMove=function(t){var i=t.target;i.x-=this._cardSpeed,i.x<=-300&&(i.x=1366+300*Math.random()),this._point=this._questionSp.localToGlobal(i.x,i.y);var s=egret.Point.distance(this._point,new egret.Point(this._qwd.x,this._qwd.y));if(s<this._testDis){if(this.stopMove(),egret.log("card.name:",i.name),egret.log("this._answer",this._answer),i.name==this._answer){if(this._stars.add(),this._stars.count>=e.WINNUM)return egret.log("win"),this._qwd.visible=!1,this.addChild(this._loves),this.addChild(this._stars),this._questionSp.visible=!1,this._overPage.visible=!0,void this._overPage.showWin(!0)}else if(this._loves.cut(),this._loves.count<=0)return egret.log("fail"),this._qwd.visible=!1,this.addChild(this._loves),this.addChild(this._stars),this._questionSp.visible=!1,this._overPage.visible=!0,void this._overPage.showWin(!1);this._questionIndex++,this.startQuestion(this._questionIndex)}},e.prototype.stopMove=function(){for(var t=0;t<this._showNum;t++){var e=this._questionSp.getChildAt(t);e.removeEventListener(egret.Event.ENTER_FRAME,this.onCardMove,this)}},e.prototype.again=function(t){this._qwd.x=3+.5*this._qwd.width,this._qwd.y=399+.5*this._qwd.height,this._questionIndex=0,this._qwd.visible=!0,this._loves.reset(),this._stars.reset(),this._overPage.visible=!1,this._questionSp.visible=!0,this.startQuestion(this._questionIndex)},e.prototype.start=function(t){this.startQuestion(this._questionIndex),this._overPage.visible=!1},e.prototype.onUpBtnBegin=function(t){this._isUp=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.onBoatMove,this)},e.prototype.onUpBtnEnd=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.onBoatMove,this)},e.prototype.onDownBtnBegin=function(t){this._isUp=!1,this.addEventListener(egret.Event.ENTER_FRAME,this.onBoatMove,this)},e.prototype.onDownBtnEnd=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.onBoatMove,this)},e.prototype.onBoatMove=function(t){this._isUp?this._qwd.y>=.5*this._qwd.height&&(this._qwd.y-=this._qwdSpeed):this._qwd.y<=1024-.5*this._qwd.height&&(this._qwd.y+=this._qwdSpeed)},e.WINNUM=10,e.FAILNUM=3,e}(egret.Sprite);__reflect(SpaceAdventure.prototype,"SpaceAdventure");var CardComponent=function(t){function e(e){var i=t.call(this)||this;return i._bg=PublicTool.createBitmapByName("spaceadventure_"+e+"_png"),i.addChild(i._bg),i._bg.anchorOffsetX=120,i._bg.anchorOffsetY=.5*i._bg.height,i}return __extends(e,t),e.prototype.addImg=function(t){for(;this.numChildren>1;)this.removeChildAt(1);this.addChild(t),t.x=-90,t.y=50-.5*this._bg.height},e.prototype.initContent=function(t,e){},e}(egret.Sprite);__reflect(CardComponent.prototype,"CardComponent");var Bg=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=Source.createBitmapByName("spaceadventure_5_png");this.addChild(t)},e.prototype.reset=function(){},e}(egret.Sprite);__reflect(Bg.prototype,"Bg");var DropCard=function(t){function e(){var e=t.call(this)||this;return e.count=3,e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=this.createBitmapByName("yellow_box_png"),e=this.createBitmapByName("violet_box_png"),i=this.createBitmapByName("blue_box_png"),s=this.createBitmapByName("red_box_png");this.addChildCenter(t),this.addChildCenter(e),this.addChildCenter(i),this.addChildCenter(s)},e.prototype.addChildCenter=function(t){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,this.addChild(t)},e.prototype.setType=function(t){void 0===t&&(t=0);for(var e=0;e<this.numChildren;e++)this.getChildAt(e).visible=!1;this.getChildAt(t).visible=!0},e.prototype.add=function(t){for(;this.numChildren>4;)this.removeChildAt(4);t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,this.addChild(t)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);__reflect(DropCard.prototype,"DropCard");var CountStars=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){var t=this.createBitmapByName("gstars_png");this.addChild(t);var i=this.createBitmapByName("stars_png");this.addChild(i),this._topMask=new egret.Shape,this.addChild(this._topMask),this._topMask.graphics.beginFill(0,1),this._topMask.graphics.drawRect(0,0,e.MOVEDIS*e.NUM,51),this._topMask.graphics.endFill(),i.mask=this._topMask,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.prototype.add=function(){this.count>=10||(this.count++,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.cut=function(){this.count<=0||(this.count--,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createDisobj=function(t){for(var e=new egret.Sprite,i=0;i<t.length;i++)e.addChild(t[i]);return e},e.prototype.reset=function(){this.count=0,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.NUM=10,e.MOVEDIS=60,e}(egret.Sprite);__reflect(CountStars.prototype,"CountStars");var EButton=function(t){function e(e,i,s,o,n,r,a,h){void 0===s&&(s=null),void 0===o&&(o=null),void 0===n&&(n=""),void 0===r&&(r=30),void 0===a&&(a=1),void 0===h&&(h="assets");var l=t.call(this)||this;return l.assets=RES.getRes("assets"),l.isPlayCartoon=!1,l.cartoonType=1,l.param={context:null,data:null},l.param.context=e,l.init(i,s,o,n,r,a,h),l}return __extends(e,t),e.prototype.init=function(t,e,i,s,o,n,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=""),void 0===o&&(o=30),void 0===n&&(n=1),void 0===r&&(r="assets"),this.cartoonType=n,this.beginFun=e,this.endFun=i,this.btnImg=new egret.Bitmap,null==r?this.btnImg.texture=RES.getRes(t):("assets"!=r&&(this.assets=RES.getRes(r)),this.btnImg.texture=this.assets.getTexture(t)),this.addChild(this.btnImg),this.btnImg.touchEnabled=!0,this.btnImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnClick,this),""!=s&&(this.textField=new egret.TextField,this.addChild(this.textField),this.textField.size=o,this.textField.textAlign="center",this.textField.stroke=1,this.textField.strokeColor=0,this.textField.text=s,this.textField.width=this.btnImg.width,this.textField.x=this.btnImg.width/2-this.textField.width/2,this.textField.y=this.btnImg.height/2-this.textField.height/2),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonBegin,this)},e.prototype.onStartBtnClick=function(t){this.dispatchEvent(new egret.Event(egret.Event.CHANGE))},e.prototype.onButtonBegin=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0,this.startX||(this.startX=this.x,this.startY=this.y);t.target;null!=this.beginFun&&this.beginFun.apply(this.param.context,[this.param.data]),this.stage.once(egret.TouchEvent.TOUCH_END,this.onButtonTouchEnd,this),egret.Tween.get(this).to({scaleX:.8,scaleY:.8,x:this.startX+.1*this.btnImg.width,y:this.startY+.1*this.btnImg.height},100,egret.Ease.sineIn)}},e.prototype.onButtonTouchEnd=function(t){var e=(t.target,function(){this.isPlayCartoon=!1,null!=this.endFun&&this.endFun.apply(this.param.context,[this.param.data])});1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},100).call(e,this)},e.prototype.onbuttonTouchTap=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0;var e=function(){this.isPlayCartoon=!1,null!=this.backFun&&this.backFun.apply(this.param.context,[this.param.data])},i=function(){1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},100).call(e,this)};egret.Tween.get(this).to({scaleX:.5,scaleY:.5,x:this.x+this.btnImg.width/4,y:this.y+this.btnImg.height/4},100,egret.Ease.sineIn).call(i,this)}},e.prototype.setBindData=function(t){this.param.data=t},e.prototype.getBindData=function(){return this.param.data},e.prototype.getBitmap=function(){return this.btnImg},e}(egret.DisplayObjectContainer);__reflect(EButton.prototype,"EButton");var EffectUtils;!function(t){function e(t,e){if(void 0===e&&(e=1e3),null==this.rotationArr&&(this.rotationArr=[]),!this.rotationArr[t.hashCode]){null!=this.rotationArr[t.hashCode]&&this.rotationArr[t.hashCode]||(this.rotationArr[t.hashCode]=!0);var i=function(){this.rotationArr[t.hashCode]&&null!=t&&(t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(i,this))};t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(i,this)}}function i(t){null==this.rotationArr&&(this.rotationArr=[]),this.rotationArr[t.hashCode]=!1}function s(t,e){void 0===e&&(e=1e3),new BitmapBlink(t,e)}function o(t){var e=80,i=t.x;egret.Tween.get(t).to({x:t.x-10},e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,2*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x-20},e)},this,3*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,4*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:i},e)},this,5*e)}function n(t){void 0===t&&(t=1)}function r(t,e,i){switch(void 0===t&&(t=""),void 0===e&&(e=1),void 0===i&&(i=!1),e){case 1:TipsUtils.showTipsDownToUp(t,i);break;case 2:TipsUtils.showTipsLeftOrRight(t,i,!0);break;case 3:TipsUtils.showTipsLeftOrRight(t,i,!1);break;case 4:TipsUtils.showTipsFromCenter(t,i);break;case 5:TipsUtils.showTipsBigToSmall(t,i)}}function a(t,e){if(void 0===e&&(e=1),!this.isPlayEffectPlay){this.isPlayEffectPlay=!0;var i=function(){this.isPlayEffectPlay=!1},s=function(){1==e?egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},500,egret.Ease.elasticOut).call(i,this):2==e?egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},500,egret.Ease.backOut).call(i,this):3==e&&egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},100).call(i,this)};egret.Tween.get(t).to({scaleX:.5,scaleY:.5,x:t.x+t.width/4,y:t.y+t.height/4},100,egret.Ease.sineIn).call(s,this)}}function h(t){var e=function(){if(null!=t){var i=function(){t.scaleX=1,t.scaleY=1,egret.Tween.get(t).to({alpha:1},1e3).call(e,self)};t.alpha=1,egret.Tween.get(t).to({scaleX:1.5,scaleY:1.5,alpha:0},1e3).call(i,self)}};e()}function l(t,e,i){void 0===i&&(i=50);var s=function(){if(null!=t){var o=function(){egret.Tween.get(t).to({y:t.y-i},e).call(s,this)};egret.Tween.get(t).to({y:t.y+i},e).call(o,this)}};s()}function c(t,e,i){void 0===i&&(i=20);var s=function(){if(null!=t){var o=function(){egret.Tween.get(t).to({rotation:-i},e).call(s,this)};egret.Tween.get(t).to({rotation:i},e).call(o,this)}};s()}function u(t,e,i){void 0===e&&(e=""),void 0===i&&(i=200);for(var s=e.split(""),o=s.length,n=0;o>n;n++)egret.setTimeout(function(){t.appendText(s[Number(this)])},n,i*n)}t.rotationEffect=e,t.removeRotationEffect=i,t.blinkEffect=s,t.shakeObj=o,t.shakeScreen=n,t.showTips=r;t.playEffect=a,t.playScaleEffect=h,t.flyObj=l,t.rockObj=c,t.typerEffect=u}(EffectUtils||(EffectUtils={}));var ETextField=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setText=function(t){void 0===t&&(t="");var e=new egret.HtmlTextParser;this.textFlow=e.parser(t)},e}(egret.TextField);__reflect(ETextField.prototype,"ETextField");var OverPage=function(t){function e(){var e=t.call(this)||this;return e.stage?e.createView():e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddStage,e),e}return __extends(e,t),e.prototype.onAddStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.createView()},e.prototype.createView=function(){var t=Source.createBitmapByName("success_2_png"),e=Source.createBitmapByName("success_1_png"),i=Source.createBitmapByName("fail_2_png");this._tryAgain=Source.createBitmapByName("fail_0_png");var s=Source.createBitmapByName("fail_1_png"),o=Source.createBitmapByName("success_0_png"),n=new egret.Sprite;this.addChild(n),n.graphics.beginFill(0,.5),n.graphics.drawRect(0,0,1366,1024),n.graphics.endFill(),this._failSp=new egret.Sprite,this.addChild(this._failSp),this._failSp.visible=!1,this._winSp=new egret.Sprite,this.addChild(this._winSp),this._winSp.addChild(t),t.name="caidai",t.y=68.48,this._failSp.addChild(s),s.name="fail",s.x=150,s.y=570,this._winSp.addChild(o),o.name="win",o.x=150,o.y=570,this._winSp.addChild(e),e.name="successStar",e.x=324,e.y=157,this._failSp.addChild(i),i.name="failStar",i.x=324,i.y=157,this.addChild(this._tryAgain),this._tryAgain.name="tryAgain",this._tryAgain.x=568,this._tryAgain.y=787,this._tryAgain.visible=!1,this._tryAgain.$touchEnabled=!0,this._winSp.visible=!1,this._failSp.visible=!1,this._winSp.visible=!1,this._failSp.visible=!1,this._start=Source.createBitmapByName("start_png"),this.addChild(this._start),this._start.$touchEnabled=!0,this._start.x=.5*(this.stage.stageWidth-this._start.width),this._start.y=.5*(this.stage.stageHeight-this._start.height),this._bgSound=new SoundPlayer,this._tryAgain.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tryAgain,this),this._start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.start,this)},e.prototype.start=function(t){this._bgSound.clear(),this._bgSound.playRes("bgmusic_mp3",1e4,.1),this._start.visible=!1,this.dispatchEvent(new egret.Event(egret.Event.CHANGE))},e.prototype.tryAgain=function(t){this.dispatchEvent(new egret.Event(egret.Event.COMPLETE))},e.prototype.showWin=function(t){this._tryAgain.visible=!0,t?(this._winSp.visible=!0,this._failSp.visible=!1):(this._winSp.visible=!1,this._failSp.visible=!0)},e}(egret.Sprite);__reflect(OverPage.prototype,"OverPage");var PublicTool=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.setXY=function(t,e,i){t.x=e/this.resWidth*this.stageWidth,t.y=i/this.resHeight*this.stageHeight,egret.log(this.stageWidth,this.stageHeight)},t.resWidth=1366,t.resHeight=1024,t.TextColors={white:16777215,milkWhite:16511407,grayWhite:13547170,yellow:16776960,lightYellow:16765813,orangeYellow:16750848,red:15799040,green:58624,blue:1742039,grayBlue:3101047,purple:15284466,pink:16724016,black:3026221,golden:16766720},t}();__reflect(PublicTool.prototype,"PublicTool");var Qieadi=function(t){function e(){var e=t.call(this)||this;return e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){var t=this.createBitmapByName("奇瓦迪_png"),e=this.createBitmapByName("success_0_png"),i=this.createBitmapByName("fail_1_png"),s=this.createBitmapByName("qwd2_png"),o=this.createBitmapByName("qwd3_png");this.addChild(t),this.addChild(e),e.x=45,e.y=-66,this.addChild(e),e.visible=!1,e.x=45,e.y=-66,this.addChild(i),i.visible=!1,i.x=87,i.y=-77,this.addChild(s),s.visible=!1,s.y=6,this.addChild(o),o.visible=!1,o.x=-19,o.y=8},e.prototype.gotoAndStop=function(t){for(var e=0;e<this.numChildren;e++)this.getChildAt(e).visible=!1;this.getChildAt(t).visible=!0},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.Sprite);__reflect(Qieadi.prototype,"Qieadi");var Source=function(){function t(){}return t.init=function(){var e=RES.getRes(Main.sourceName+"_json");this.list=e.items;for(var i=0;i<e.items.length;i++){var s=e.items[i].img,o=new egret.Bitmap(RES.getRes(s)),n=e.items[i].name;o.name=n,o.width=o.height=220,this.images.push(o)}for(var r=0;r<t.groups;r++){for(var a=[],h=0;h<this.images.length;h++)a.push(h);this.questionList.push(this.getQuestion(r%this.images.length,a))}egret.log(this.questionList)},t.reArrange=function(){this.questionList=[];for(var e=0;e<t.groups;e++){for(var i=[],s=0;s<this.images.length;s++)i.push(s);this.questionList.push(this.getQuestion(e%this.images.length,i))}},t.getQuestion=function(e,i){var s=[];s.push(i[e]),i.splice(e,1);for(var o=0;o<t.showNum-1;o++){var n=Math.floor(Math.random()*(i.length-o));0>n&&(n=0),s.push(i[n]),i.splice(n,1)}for(var r=[],a=0;a<t.showNum;a++){var h=Math.floor(Math.random()*(t.showNum-a));0>h&&(h=0),r.push(s[h]),s.splice(h,1)}return r},t.changeQusetion=function(t){for(var e=[],i=0;i<this.images.length;i++)e.push(i);this.questionList[t]=[],this.questionList[t].push(e[t]),e.splice(t,1);for(var s=0;2>s;s++){var o=Math.floor(Math.random()*(e.length-s));0>o&&(o=0),this.questionList[t].push(e[o]),e.splice(o,1)}for(var n=[],r=0;3>r;r++){var a=Math.floor(Math.random()*(3-r));0>a&&(a=0),n.push(this.questionList[t][a]),this.questionList[t].splice(a,1)}this.questionList[t]=n},t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e.smoothing=!0,e},t.randomIndex=function(t){for(var e=[],i=0;t>i;i++)e.push(i);for(var s=[],o=0;t>o;o++){var n=Math.floor(Math.random()*(t-o));0>n&&(n=0),s.push(e[n]),e.splice(n,1)}return s},t.distance=function(t,e){var i=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y));return i},t.groups=13,t.showNum=2,t.root="resource/",t.images=[],t.audios=[],t.questionList=[],t}();__reflect(Source.prototype,"Source");var BitmapBlink=function(t){function e(e,i,s){void 0===s&&(s=!0);var o=t.call(this)||this;return o._target=e,o._time=i,s&&o.start(),o}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.alpha-=.045,this.checkOver()||this._target.alpha<=.6&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.alpha+=.045,this.checkOver()||this._target.alpha>=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))
},e.prototype.checkOver=function(){var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.alpha=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BitmapBlink.prototype,"BitmapBlink");var TipsUtils;!function(t){function e(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=24,i.y=PublicTool.stageHeight/2,e?i.textColor=PublicTool.TextColors.red:i.textColor=PublicTool.TextColors.green,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2-i.width/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i);var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)},o=function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)};i.visible=!0,egret.Tween.get(i).to({y:i.y-120,alpha:1},800,egret.Ease.backOut).call(o,this)}function i(t,e,i){void 0===t&&(t=""),void 0===e&&(e=!1),void 0===i&&(i=!0);var s=new egret.TextField;s.size=24,s.y=PublicTool.stageHeight/2,e?s.textColor=PublicTool.TextColors.red:s.textColor=PublicTool.TextColors.green,s.alpha=0,s.text=t,s.strokeColor=0,i?s.x=-s.width:s.x=PublicTool.stageWidth,s.stroke=2,s.bold=!0,s.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(s)||PublicTool.topSP.addChild(s),i?egret.Tween.get(s).to({x:PublicTool.stageWidth/2-s.width/2-50,alpha:1},300,egret.Ease.sineInOut):egret.Tween.get(s).to({x:PublicTool.stageWidth/2-s.width/2+50,alpha:1},300,egret.Ease.sineInOut),egret.setTimeout(function(){i?egret.Tween.get(s).to({x:s.x+100},500):egret.Tween.get(s).to({x:s.x-100},500)},this,300),egret.setTimeout(function(){i?egret.Tween.get(s).to({x:PublicTool.stageWidth},300,egret.Ease.sineIn):egret.Tween.get(s).to({x:-s.width},300,egret.Ease.sineIn)},this,800),egret.setTimeout(function(){PublicTool.topSP.contains(s)&&(PublicTool.topSP.removeChild(s),s=null)},this,1100)}function s(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=44,i.y=PublicTool.stageHeight/2-150,e?i.textColor=PublicTool.TextColors.white:i.textColor=PublicTool.TextColors.golden,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.scaleX=0,i.scaleY=0;var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)};egret.Tween.get(i).to({scaleX:1,scaleY:1,alpha:1},200),egret.setTimeout(function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)},this,1e3)}function o(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=24,i.y=PublicTool.stageHeight/2,e?i.textColor=PublicTool.TextColors.red:i.textColor=PublicTool.TextColors.green,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.scaleX=4,i.scaleY=4;var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)};egret.Tween.get(i).to({scaleX:1,scaleY:1,alpha:1},200),egret.setTimeout(function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)},this,1e3)}t.showTipsDownToUp=e,t.showTipsLeftOrRight=i,t.showTipsFromCenter=s,t.showTipsBigToSmall=o}(TipsUtils||(TipsUtils={}));